name: Cypress Tests

on:
  # Run on pushes to the 'main' branch
  push:
    branches: [main]

jobs:
  cypress-run:
    runs-on: ubuntu-latest

    steps:
      # 1. Check out the repository code
      - name: Checkout
        uses: actions/checkout@v4

      # 2. Setup PNPM (using your version 10)
      - name: Setup PNPM
        uses: pnpm/action-setup@v4
        with:
          version: 10

      # 3. Setup Node.js (using your version 24)
      # This step also caches the pnpm store for fast installs
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 24
          cache: "pnpm" # Caches the pnpm global store

      # 4. Install project dependencies
      - name: Install dependencies
        run: pnpm install

      # 5. Run Cypress tests
      # This uses the official action, which is the best practice.
      # It caches the Cypress binary and runs your command.
      - name: Run Cypress tests
        uses: cypress-io/github-action@v6
        with:
          # Use the exact script from your package.json
          command: pnpm run cy:run
          # Run headless in Electron (fastest for CI)
          browser: electron
